[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Methods for analysis of spatial peptidergic communication networks",
    "section": "",
    "text": "Figure 1: Describe what peptidergic networks are.\n\n\n\nCommunication in the brain occurs in 2 main ways: wired communication and wireless communication.\nWired communication occurs across a synapse (between dendrite and axon) with electrical and chemical signals.\nWireless communication occurs pairs of cells that diffuse neuropeptides and cells that bind to these neuropeptides. 37 such pairs have been identified in literature and each pair constitutes a distinct communication network between neurons.\nIn this study, we develop computational methods to study the organization of these graphs.\nASSUMPTION: - POINT NEURONS\n\nIntroduction\nPeptides released by one neuron can bind to G-protein coupled receptors (GPCRs) on other neurons and modulate their activity. Many such cognate neuropeptide- GPCR pairs have been identified in the literature. These constitute multiple molecularly distinct communication networks between neurons. Single cell transcriptomic data suggests that a vast majority of cortical neurons participate in such communication in a cell-type dependent manner(Smith et al. 2019).\nSpatial transcriptomic experiments measure gene expression while preserving context within the tissue. We consider a recent whole mouse brain dataset obtained with an in-situ hybridization-based technique called MERFISH (Yao et al. 2023) and develop graph-based methods to study the organization of putative peptidergic communication networks.\nWe explore regimes in which neighborhood information is helpful for cell type classification with graph neural networks and adapt Node2Vec (Grover and Leskovec 2016) to obtain multilayer graph embeddings. We speculate that cell clusters obtained in this way correspond to spatial domains relevant from a functional point of view.\n\n\nBackground on spatial transcriptomic data\nSpatial transcriptomic experiments measure gene expression while preserving spatial context. There are many technologies to acquire such data, with trade-offs in spatial resolution, speed, and compatibility with other kinds of experiments on the same tissue sample Chen et al. (2023). Some of these technologies, namely SeqFISH, MERFISH, Slide-Seq have been used to produce atlas scale datasets in the mouse brain by the BICCN~Hawrylycz et al. (2023). Here we focus on a whole mouse brain dataset obtained with an in-situ hybridization based technique called MERFISH Yao et al. (2023). This dataset consists of expression measurements of approximately 500 genes in 4 million cells from a single mouse brain.\nWe focus on the VISp region in this study as shown in Figure 2.\n\n\n\n\n\n\nFigure 2: Spatial Transcriptomic data from VISp.\n\n\n\n\n\nBackground on neuropeptidergic communication\nLigands are small molecules that bind selectively to receptor proteins. Peptides are small chains of amino acids. Here the ligands of interest are peptides, and the receptor proteins of interest are GPCRs Rosenbaum, Rasmussen, and Kobilka (2009). Peptides released by one neuron can bind to GPCRs on other neurons and modulate their activity. Thus, compatible (a.k.a cognate) peptide-GPCR pairs can be considered as unique communication channels Smith et al. (2019). ~ Importantly, such peptidergic signaling is slower and longer lasting compared to synaptic signaling. Recently neurons have been grouped into based on genome-wide mRNA expression (\\(\\sim\\) 20,000 unique genes per cell). Combinatorial expression of neuropeptides and receptors enables local, type specific communication between neurons. Computational studies also suggest that such neuron-type–specific local neuromodulation may be a critical piece of the biological credit-assignment puzzle Liu et al. (2021).\n\n\nMultilayer graph construction\nPeptidergic Communication networks are directed multilayer graphs.\nThe multilayer graph G is the set \\(\\{V, \\{E_l\\}\\}\\) where:\n\\(V\\) is the set of vertices (cells).\n\\(E_l\\) s the set of directed edges for the lth network.\nFor the \\(l\\) th network, an edge exists from vertex \\(i\\) to vertex \\(j\\) if all the following conditions are met:\n\ndistance \\(d[i,j] \\leq d_{threshold}\\)\nvertex i expresses the peptide precursor gene\nvertex j expresses the GPCR gene\n\nWe set \\(d_{threshold} = 40 \\textmu m\\) for all experiments unless mentioned otherwise.\n\n\nNode classification with graph neural networks\nGraph neural networks combine features of nodes that are adjacent according to the underlying graph.\nA nonlinear function ∅ of aggregated (sum here) weighted node features determines updated node representation.\nIn GATv2, the node features are weighted using a function of node pairs, \\(\\theta\\).\nFunctions \\(\\phi\\) and \\(\\theta\\) are learned to optimize a per-node classification objective.\nHere, we consider cells as nodes, and their gene expression as initial node features.\nSupertype classification is challenging when few genes are available.\nWe find that gene expression in neighboring cells can improve classification in this regime.\n\n\nNode embeddings\nNode2Vec learns an embedding \\(f(u)\\) that is predictive of the neighborhood \\(\\mathcal{N}(u)\\) of each node \\(u\\).\nThe neighborhood for each node is determined through fixed length, 2nd order random walks starting from each node.\nParameters \\(p\\) and \\(q\\) determine the transition probabilities for the random walk.\n\\[\nmax_f \\sum_{u \\in V}{P(\\mathcal{N}(u) | f(u))}\n\\]\nSpectral clustering frames the problem as an eigen decomposition. Specifically, the eigenvectors of the Laplacian matrix are used as features for clustering.\n\n\nSimulation\nWe build intuition for how peptidergic connectivity could partition cells into meaningful groups even in the absence of explicit gene expression information with a toy problem.\nThe type x type adjacency matrix can be sampled to obtain a cell x cell adjacency matrix. The block structure is equivalent to the graph having distinct connected components.\nClustering the embeddings obtained with Node2Vec is a scalable way to identify such components.\n\n\nMultilayer graph clustering\nNode2Vec embeddings cluster according to the underlying block structure in a manner that is robust to sparsity as well as noise in the cell x cell graph.\nFor multilayer graphs, one approach is to obtain independent embeddings for each layer in the multigraph. This approach can identify all the ‘types’ when the blocks are chosen carefully across layers\nThe peptidergic multilayer graph does not contain any edges between layers. We can exploit this fact to jointly consider all the layers of the graph, and efficiently construct random walks from each layer.\n\n\nApplication to MERFISH VISp data\nWe inspect the utility of graph embeddings in identifying celltypes (subclass) and spatial groupings in a few different settings:\n\nconsidering only proximity of cells in the graph (distance)\nconcatenated embeddings of individual peptidergic graphs (independent)\ncollapsing the multi-layer graphs into a single layer graph (squashed)\njointly considering the multilayer graphs with an adapted Node2Vec model (joint)\n\n\n\nGene Imputation\nThe expression of peptidergic communication genes that were not part of the MERFISH dataset can be recovered through imputation. Several tools have been benchmarked for this task ~, and we used the top performing model Tangram to impute values of all peptidergic communication genes.\nTangram maps cells from a scRNA-seq dataset to cells (or voxels) from a spatial transcriptomic dataset.\nTangram learns a mapping matrix M defined such that \\(M_{ij} \\geq 0\\) is the probability of cell i (from scRNA-seq) mapping to cell \\(j\\) (from spatial transcriptomic data).\nWe assessed imputation performance by using peptidergic communication genes that were already measured as test data.\nWe conclude that the correlation between predicted gene expression and actual gene expression is not strong enough for us to use predicted values for the 14 other peptidergic communication gene pairs.\nIn particular, a non trivial amount of null gene expression values were mapped to positive values for most genes.\nWe attribute this to the relatively small number of cells present in the spatial transcriptomic data after subsetting.\n\n\nLimitations and future work\nOnly 5 out of the 37 cognate neuropeptide precursor and GPCR pairs were experimentally measured in the MERFISH dataset, which precludes an assessment at more detailed levels of the taxonomy\nNeuron morphology may be an important consideration relevant for the full spatial extent of peptidergic communication. Arbor density representations derived from patch-seq datasets could offer a way forward.\n\n\nApplication of GNNs for analysis of spatial transcriptomic data\nThis section covers recent GNN-based methods described in the literature Figure 1.\nimport numpy as np\nfor i in range(1)\n    pass\nSpaGCN~(Hu et al. 2021): This approach uses gene expression, spatial location, and a histology image to construct a graph. Nodes are either cells (MERFISH data), or spots (10x Visium data). Edge weights capture proximity in spatial coordinates and similarity of RGB values in the histology image. A GCN layer Kipf and Welling (2016) provides node embeddings that are clustered by a differentiable clustering layer Xie, Girshick, and Farhadi (2015). These layers are trained jointly to optimize a clustering objective Xie, Girshick, and Farhadi (2015). The resulting node clusters are interpreted as domains. A separate differential gene analysis is performed to obtain across domains.\nWe thank Tom Chartrand, Ian Convy, Olga Gliko, Anna Grim, Yeganeh Marghi, Uygar Sümbül, Meghan Turner, and Kasey Zhang for helpful feedback and discussions.\n\n\n\n\n\nReferences\n\nChen, Tsai-Ying, Li You, Jose Angelito U Hardillo, and Miao-Ping Chien. 2023. “Spatial Transcriptomic Technologies.” Cells 12 (16): 2042.\n\n\nGrover, Aditya, and Jure Leskovec. 2016. “Node2vec: Scalable Feature Learning for Networks.” In Proceedings of the 22nd ACM SIGKDD International Conference on Knowledge Discovery and Data Mining, 855–64.\n\n\nHawrylycz, Michael, Maryann E Martone, Giorgio A Ascoli, Jan G Bjaalie, Hong-Wei Dong, Satrajit S Ghosh, Jesse Gillis, et al. 2023. “A Guide to the BRAIN Initiative Cell Census Network Data Ecosystem.” PLoS Biology 21 (6): e3002133.\n\n\nHu, Jian, Xiangjie Li, Kyle Coleman, Amelia Schroeder, Nan Ma, David J Irwin, Edward B Lee, Russell T Shinohara, and Mingyao Li. 2021. “SpaGCN: Integrating Gene Expression, Spatial Location and Histology to Identify Spatial Domains and Spatially Variable Genes by Graph Convolutional Network.” Nature Methods 18 (11): 1342–51.\n\n\nKipf, Thomas N, and Max Welling. 2016. “Semi-Supervised Classification with Graph Convolutional Networks.” arXiv Preprint arXiv:1609.02907.\n\n\nLein, Ed, Lars E Borm, and Sten Linnarsson. 2017. “The Promise of Spatial Transcriptomics for Neuroscience in the Era of Molecular Cell Typing.” Science 358 (6359): 64–69.\n\n\nLiu, Yuhan Helena, Stephen Smith, Stefan Mihalas, Eric Shea-Brown, and Uygar Sümbül. 2021. “Cell-Type–Specific Neuromodulation Guides Synaptic Credit Assignment in a Spiking Neural Network.” Proceedings of the National Academy of Sciences 118 (51): e2111821118.\n\n\nMarx, Vivien. 2021. “Method of the Year: Spatially Resolved Transcriptomics.” Nature Methods 18 (1): 9–14.\n\n\nMoffitt, Jeffrey R, Emma Lundberg, and Holger Heyn. 2022. “The Emerging Landscape of Spatial Profiling Technologies.” Nature Reviews Genetics 23 (12): 741–59.\n\n\nOrtiz, Cantin, Marie Carlén, and Konstantinos Meletis. 2021. “Spatial Transcriptomics: Molecular Maps of the Mammalian Brain.” Annual Review of Neuroscience 44 (1): 547–62.\n\n\nRosenbaum, Daniel M, Søren GF Rasmussen, and Brian K Kobilka. 2009. “The Structure and Function of g-Protein-Coupled Receptors.” Nature 459 (7245): 356–63.\n\n\nSmith, Stephen J, Uygar Sümbül, Lucas T Graybuck, Forrest Collman, Sharmishtaa Seshamani, Rohan Gala, Olga Gliko, et al. 2019. “Single-Cell Transcriptomic Evidence for Dense Intracortical Neuropeptide Networks.” Elife 8: e47889.\n\n\nXie, J, R Girshick, and A Farhadi. 2015. “Unsupervised Deep Embedding for Clustering Analysis. ArXiv.” Preprint Posted Online on Nov 19.\n\n\nYao, Zizhen, Cindy TJ van Velthoven, Michael Kunst, Meng Zhang, Delissa McMillen, Changkyu Lee, Won Jung, et al. 2023. “A High-Resolution Transcriptomic and Spatial Atlas of Cell Types in the Whole Mouse Brain.” Nature 624 (7991): 317–32."
  }
]